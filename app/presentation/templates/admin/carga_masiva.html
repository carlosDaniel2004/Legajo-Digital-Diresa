{% extends 'layouts/dashboard.html' %}
{% from "components/_form_helpers.html" import render_field %}

{% block title %}Carga Masiva de Personal{% endblock %}

{% block dashboard_content %}
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="h3 mb-0">Carga Masiva de Personal desde Excel</h1>
        <a href="{{ url_for('legajo.listar_personal') }}" class="btn btn-secondary">
            <i class="bi bi-arrow-left-circle me-1"></i> Volver a la Lista
        </a>
    </div>

    {% include 'components/_alerts.html' %}

    <div class="card shadow-sm">
        <div class="card-header">
            <h5 class="card-title mb-0">Instrucciones</h5>
        </div>
        <div class="card-body">
            <p>Siga estos pasos para registrar múltiples trabajadores a la vez:</p>
            <ol>
                <li>
                    Descargue la plantilla de Excel haciendo clic en el siguiente botón.
                    <br>
                    <a href="{{ url_for('legajo.descargar_plantilla_carga_masiva') }}" class="btn btn-sm btn-success mt-2">
                        <i class="bi bi-file-earmark-excel-fill me-1"></i> Descargar Plantilla
                    </a>
                </li>
                <li>Llene la plantilla con los datos de los trabajadores. <strong>No cambie el nombre de las columnas.</strong></li>
                <li>Guarde el archivo y súbalo usando el formulario a continuación.</li>
                <li>El sistema procesará el archivo y le informará del resultado.</li>
            </ol>
            <p class="text-danger small">
                <strong>Importante:</strong> Los campos DNI, Nombres, Apellidos, Sexo, Fecha de Nacimiento, Correo, Unidad Administrativa y Fecha de Ingreso son obligatorios.
                Las fechas deben tener el formato <strong>YYYY-MM-DD</strong>.
            </p>
        </div>
    </div>

    <div class="card shadow-sm mt-4">
        <div class="card-header">
            <h5 class="card-title mb-0">Subir Archivo</h5>
        </div>
        <div class="card-body">
            <form method="POST" enctype="multipart/form-data" novalidate>
                {{ form.hidden_tag() }}
                {{ render_field(form.excel_file) }}
                <div class="mt-3">
                    {{ form.submit(class="btn btn-primary") }}
                </div>
            </form>
        </div>
    </div>
{% endblock %}
